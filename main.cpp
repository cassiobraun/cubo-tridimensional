#include <iostream>
#include "cubo.h"
#include "mandarSerial.h"
#include <stdexcept> // Para runtime_error
#include <cstdlib>   // Para system, caso necessário
#include <thread>    // Substitui Sleep() por std::this_thread::sleep_for
#include <chrono>    // Substitui Sleep() por std::this_thread::sleep_for

const int SIZEw=8;

int main()
{
    cubo c;

    //para poupar tempo modifiquei manualmente apenas uma face do cubo e usei uma função para passar para outras camadas

uint8_t face0[SIZEw][SIZEw] = {
        {15, 00, 00, 00, 00, 00, 00, 15},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {15, 00, 00, 00, 00, 00, 00, 15},
    };
        uint8_t face1[SIZEw][SIZEw] = {
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
    };

    uint8_t face2[SIZEw][SIZEw] = {
        {00, 15, 15, 00, 00, 15, 15, 00},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {00, 15, 15, 00, 00, 15, 15, 00},
    };

        uint8_t face3[SIZEw][SIZEw] = {
        {00, 00, 15, 15, 15, 15, 00, 00},
        {00, 15, 15, 00, 00, 15, 15, 00},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {00, 15, 15, 00, 00, 15, 15, 00},
        {00, 00, 15, 15, 15, 15, 00, 00},
    };

    uint8_t face4[SIZEw][SIZEw] = {
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
    };
        uint8_t face5[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };

    uint8_t face6[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };
        uint8_t face7[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };

    uint8_t face8[SIZEw][SIZEw] = {
        {15, 00, 00, 00, 00, 00, 00, 15},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {15, 00, 00, 00, 00, 00, 00, 15},
    };

        uint8_t face9[SIZEw][SIZEw] = {
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
    };

    uint8_t face10[SIZEw][SIZEw] = {
        {15, 00, 00, 00, 00, 00, 00, 15},
        {00, 15, 15, 15, 15, 15, 15, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 15, 15, 15, 15, 15, 15, 00},
        {15, 00, 00, 00, 00, 00, 00, 15},
    };
        uint8_t face11[SIZEw][SIZEw] = {
        {15, 00, 00, 00, 00, 00, 00, 15},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 00, 15, 15, 15, 15, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 15, 15, 15, 15, 00, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {15, 00, 00, 00, 00, 00, 00, 15},
    };

    uint8_t face12[SIZEw][SIZEw] = {
        {15, 00, 00, 00, 00, 00, 00, 15},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {15, 00, 00, 00, 00, 00, 00, 15},
    };
        uint8_t face13[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };

    uint8_t face14[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };

        uint8_t face15[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 00, 15, 15, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };

    uint8_t face16[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 15, 15, 15, 15, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 15, 00, 00, 15, 00, 00},
        {00, 00, 15, 15, 15, 15, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };
        uint8_t face17[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 15, 15, 15, 15, 15, 15, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 15, 00, 15, 15, 00, 15, 00},
        {00, 15, 00, 15, 15, 00, 15, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 15, 15, 15, 15, 15, 15, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };

    uint8_t face18[SIZEw][SIZEw] = {
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 00, 15, 15, 15, 15, 00, 15},
        {15, 00, 15, 00, 00, 15, 00, 15},
        {15, 00, 15, 00, 00, 15, 00, 15},
        {15, 00, 15, 15, 15, 15, 00, 15},
        {15, 00, 00, 00, 00, 00, 00, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
    };
        uint8_t face19[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 15, 15, 15, 15, 15, 15, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 15, 00, 00, 00, 00, 15, 00},
        {00, 15, 15, 15, 15, 15, 15, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };

    uint8_t face20[SIZEw][SIZEw] = {
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
    };

        uint8_t face21[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 15, 15, 15, 15, 00, 00},
        {00, 00, 15, 15, 15, 15, 00, 00},
        {00, 00, 15, 15, 15, 15, 00, 00},
        {00, 00, 15, 15, 15, 15, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };

    uint8_t face22[SIZEw][SIZEw] = {
        {00, 00, 15, 15, 15, 15, 00, 00},
        {00, 00, 15, 15, 15, 15, 00, 00},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {00, 00, 15, 15, 15, 15, 00, 00},
        {00, 00, 15, 15, 15, 15, 00, 00},
    };
        uint8_t face23[SIZEw][SIZEw] = {
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 15, 00, 00, 00, 00, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
    };

    uint8_t face24[SIZEw][SIZEw] = {
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 00, 00, 15, 15, 15},
        {15, 15, 15, 00, 00, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
    };
    uint8_t face25[SIZEw][SIZEw] = {
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
        {15, 15, 15, 15, 15, 15, 15, 15},
    };

    uint8_t face26[SIZEw][SIZEw] = {
        {15, 00, 15, 00, 15, 00, 15, 00},
        {00, 15, 00, 15, 00, 15, 00, 15},
        {15, 00, 15, 00, 15, 00, 15, 00},
        {00, 15, 00, 15, 00, 15, 00, 15},
        {15, 00, 15, 00, 15, 00, 15, 00},
        {00, 15, 00, 15, 00, 15, 00, 15},
        {15, 00, 15, 00, 15, 00, 15, 00},
        {00, 15, 00, 15, 00, 15, 00, 15},
    };

        uint8_t face27[SIZEw][SIZEw] = {
        {00, 15, 00, 15, 00, 15, 00, 15},
        {15, 00, 15, 00, 15, 00, 15, 00},
        {00, 15, 00, 15, 00, 15, 00, 15},
        {15, 00, 15, 00, 15, 00, 15, 00},
        {00, 15, 00, 15, 00, 15, 00, 15},
        {15, 00, 15, 00, 15, 00, 15, 00},
        {00, 15, 00, 15, 00, 15, 00, 15},
        {15, 00, 15, 00, 15, 00, 15, 00},
    };

    uint8_t face28[SIZEw][SIZEw] = {
        {15, 15, 15, 15, 00, 00, 00, 00},
        {15, 15, 15, 15, 00, 00, 00, 00},
        {15, 15, 15, 15, 00, 00, 00, 00},
        {15, 15, 15, 15, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };
        uint8_t face29[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 15, 15, 15, 15},
        {00, 00, 00, 00, 15, 15, 15, 15},
        {00, 00, 00, 00, 15, 15, 15, 15},
        {00, 00, 00, 00, 15, 15, 15, 15},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
    };

    uint8_t face30[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {15, 15, 15, 15, 00, 00, 00, 00},
        {15, 15, 15, 15, 00, 00, 00, 00},
        {15, 15, 15, 15, 00, 00, 00, 00},
        {15, 15, 15, 15, 00, 00, 00, 00},
    };
    uint8_t face31[SIZEw][SIZEw] = {
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 00, 00, 00, 00},
        {00, 00, 00, 00, 15, 15, 15, 15},
        {00, 00, 00, 00, 15, 15, 15, 15},
        {00, 00, 00, 00, 15, 15, 15, 15},
        {00, 00, 00, 00, 15, 15, 15, 15},
    };

            c.passarFaceParaCamadas(face0 , 0);
            c.passarFaceParaCamadas(face1 , 1);
            c.passarFaceParaCamadas(face2 , 2);
            c.passarFaceParaCamadas(face3 , 3 );
            c.passarFaceParaCamadas(face4, 4);
            c.passarFaceParaCamadas(face5, 5 );
            c.passarFaceParaCamadas(face6,6 );
            c.passarFaceParaCamadas(face7, 7);
            c.passarFaceParaCamadas(face8,8);
            c.passarFaceParaCamadas(face9, 9);
            c.passarFaceParaCamadas(face10,10);
            c.passarFaceParaCamadas(face11, 11);
            c.passarFaceParaCamadas(face12, 12);
            c.passarFaceParaCamadas(face13, 13);
            c.passarFaceParaCamadas(face14, 14);
            c.passarFaceParaCamadas(face15, 15);
            c.passarFaceParaCamadas(face16, 16);
            c.passarFaceParaCamadas(face17, 17);
            c.passarFaceParaCamadas(face18, 18);
            c.passarFaceParaCamadas(face19, 19);
            c.passarFaceParaCamadas(face20, 20);
            c.passarFaceParaCamadas(face21 , 21);
            c.passarFaceParaCamadas(face22, 22);
            c.passarFaceParaCamadas(face23, 23);
            c.passarFaceParaCamadas(face24, 24);
            c.passarFaceParaCamadas(face25, 25);
            c.passarFaceParaCamadas(face26, 26);
            c.passarFaceParaCamadas(face27, 27);
            c.passarFaceParaCamadas(face28, 28);
            c.passarFaceParaCamadas(face29, 29 );
            c.passarFaceParaCamadas(face30, 30 );
            c.passarFaceParaCamadas(face31, 31);


    ///parte serial



    mandarSerial serial("COM5", 115200);


    if (!serial.isOpen()) {
        return 1;
    }

    uint8_t frame = 0;

    for (frame = 0; frame < 32; frame++) {


        serial.sendFrame(c, frame);

    }


    do {

frame=0;

    while (true) {
        // Ativa o próximo frame no ARM

        // Avança para o próximo frame

        frame = (frame + 1) % 32;


    serial.sendByte(ATX);
    serial.sendByte(frame|0x80);

    std::cout << "Comando ATX enviado. Cubo ativado!" << std::endl;

        // Aguarda antes de enviar o próximo frame

        std::this_thread::sleep_for(std::chrono::milliseconds(500));

        // Verifica se o usuário quer sair

        if (_kbhit() && _getch() == 27) { // 27 é o código ASCII do ESC
            break;
        }
    }

} while (false); // Laço principal só executado uma vez



return 0;
}
